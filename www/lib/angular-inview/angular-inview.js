(function(){"use strict";var n,e,t,o,u,r,i,l,c,f,s,a,m,h,d,p,w,v,b,g=[].slice;u=angular.module("angular-inview",[]).directive("inView",["$parse",function(n){return{restrict:"A",require:"?^inViewContainer",link:function(e,t,u,r){var c,f,s,a,h,d;if(u.inView)return c=n(u.inView),f={element:t,wasInView:!1,offset:0,customDebouncedCheck:null,callback:function(n,o,u){return null==n&&(n={}),e.$evalAsync(function(r){return function(){return n.inViewTarget=t[0],c(e,{$event:n,$inview:o,$inviewpart:u})}}(this))}},null!=u.inViewOptions&&(s=e.$eval(u.inViewOptions))&&(f.offset=s.offset||[s.offsetTop||0,s.offsetBottom||0],s.debounce&&(f.customDebouncedCheck=l(function(n){return i([f],t[0],n)},s.debounce))),a=null!=(h=null!=(d=f.customDebouncedCheck)?d:null!=r?r.checkInView:void 0)?h:v,null!=r?r.addItem(f):o(f),setTimeout(a),e.$on("$destroy",function(){return null!=r&&r.removeItem(f),m(f)})}}}]).directive("inViewContainer",function(){return{restrict:"AC",controller:["$element",function(n){return this.items=[],this.addItem=function(n){return this.items.push(n)},this.removeItem=function(n){var e;return this.items=function(){var t,o,u,r;for(u=this.items,r=[],t=0,o=u.length;o>t;t++)e=u[t],e!==n&&r.push(e);return r}.call(this)},this.checkInView=function(e){return function(t){var o,u,r,l;for(l=e.items,u=0,r=l.length;r>u;u++)o=l[u],null!=o.customDebouncedCheck&&o.customDebouncedCheck();return i(function(){var n,e,t,u;for(t=this.items,u=[],n=0,e=t.length;e>n;n++)o=t[n],null==o.customDebouncedCheck&&u.push(o);return u}.call(e),n[0],t)}}(this),this}],link:function(n,e,t,o){return e.bind("scroll",o.checkInView),h(o),n.$on("$destroy",function(){return e.unbind("scroll",o.checkInView),w(o)})}}}),t=[],o=function(n){return t.push(n),r()},m=function(n){var e;return t=function(){var o,u,r;for(r=[],o=0,u=t.length;u>o;o++)e=t[o],e!==n&&r.push(e);return r}(),p()},n=[],h=function(e){return n.push(e),r()},w=function(e){var t;return n=function(){var o,u,r;for(r=[],o=0,u=n.length;u>o;o++)t=n[o],t!==e&&r.push(t);return r}(),p()},e=!1,b=function(e){var o,u,r;for(u=0,r=n.length;r>u;u++)o=n[u],o.checkInView(e);return t.length?v(e):void 0},r=function(){return e?void 0:(e=!0,angular.element(window).bind("checkInView click ready scroll resize",b))},p=function(){return!e||t.length||n.length?void 0:(e=!1,angular.element(window).unbind("checkInView click ready scroll resize",b))},d=function(n,e,t,o,u){var r,i;if(t){if(r=c(e.element[0]).top+window.pageYOffset,i=o&&u&&"neither"||o&&"top"||u&&"bottom"||"both",!e.wasInView||e.wasInView!==i||r!==e.lastOffsetTop)return e.lastOffsetTop=r,e.wasInView=i,e.callback(n,!0,i)}else if(e.wasInView)return e.wasInView=!1,e.callback(n,!1)},i=function(n,e,t){var o,u,r,i,l,m,h,p,w,v,b,g,k,V,I;if(I={top:0,bottom:s()},e&&e!==window){if(o=c(e),o.top>I.bottom||o.bottom<I.top){for(m=0,p=n.length;p>m;m++)l=n[m],d(t,l,!1);return}o.top>I.top&&(I.top=o.top),o.bottom<I.bottom&&(I.bottom=o.bottom)}for(V=[],h=0,w=n.length;w>h;h++)l=n[h],i=l.element[0],o=c(i),r=o.top+(a(l.offset)?f(o,l.offset):parseInt(null!=(v=null!=(b=l.offset)?b[0]:void 0)?v:l.offset)),u=o.bottom+(a(l.offset)?f(o,l.offset):parseInt(null!=(g=null!=(k=l.offset)?k[1]:void 0)?g:l.offset)),r<I.bottom&&u>=I.top?V.push(d(t,l,!0,u>I.bottom,r<I.top)):V.push(d(t,l,!1));return V},a=function(n){return"string"==typeof n&&"%"===n.slice(-1)},f=function(n,e){var t;return t=e.substring(0,e.length-1),(n.bottom-n.top)*(t/100)},s=function(){var n,e,t;return(n=window.innerHeight)?n:(e=document.compatMode,(e||!("undefined"!=typeof $&&null!==$&&null!=(t=$.support)?t.boxModel:void 0))&&(n="CSS1Compat"===e?document.documentElement.clientHeight:document.body.clientHeight),n)},c=function(n){var e,t,o;if(null!=n.getBoundingClientRect)return n.getBoundingClientRect();for(o=0,e=n;e;)o+=e.offsetTop,e=e.offsetParent;for(t=n.parentElement;t;)null!=t.scrollTop&&(o-=t.scrollTop),t=t.parentElement;return{top:o,bottom:o+n.offsetHeight}},l=function(n,e){var t;return t=null,function(){var o;return o=1<=arguments.length?g.call(arguments,0):[],null!=t&&clearTimeout(t),t=setTimeout(function(){return n.apply(null,o)},null!=e?e:100)}},v=function(n){var e,o,u;for(o=0,u=t.length;u>o;o++)e=t[o],null!=e.customDebouncedCheck&&e.customDebouncedCheck();return i(function(){var n,o,u;for(u=[],n=0,o=t.length;o>n;n++)e=t[n],null==e.customDebouncedCheck&&u.push(e);return u}(),null,n)},"function"==typeof define&&define.amd?define(["angular"],u):"undefined"!=typeof module&&module&&module.exports&&(module.exports=u)}).call(this);