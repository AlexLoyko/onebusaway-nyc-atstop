!function(){"use strict";angular.module("leaflet-directive",[]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletEvents",function(e,a,r,t,n){var o;return{restrict:"EA",replace:!0,scope:{center:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(a){o=e.defer(),this.getMap=function(){return o.promise},this.getLeafletScope=function(){return a}}],link:function(e,l,i){function s(){isNaN(i.width)?l.css("width",i.width):l.css("width",i.width+"px")}function u(){isNaN(i.height)?l.css("height",i.height):l.css("height",i.height+"px")}var c=t.isDefined,d=r.setDefaults(e.defaults,i.id),f=n.genDispatchMapEvent,g=n.getAvailableMapEvents();c(i.width)&&(s(),e.$watch(function(){return l[0].getAttribute("width")},function(){s(),p.invalidateSize()})),c(i.height)&&(u(),e.$watch(function(){return l[0].getAttribute("height")},function(){u(),p.invalidateSize()}));var p=new L.Map(l[0],r.getMapCreationDefaults(i.id));if(o.resolve(p),c(i.center)||p.setView([d.center.lat,d.center.lng],d.center.zoom),!c(i.tiles)&&!c(i.layers)){var y=L.tileLayer(d.tileLayer,d.tileLayerOptions);y.addTo(p),a.setTiles(y,i.id)}if(c(p.zoomControl)&&c(d.zoomControlPosition)&&p.zoomControl.setPosition(d.zoomControlPosition),c(p.zoomControl)&&d.zoomControl===!1&&p.zoomControl.removeFrom(p),c(p.zoomsliderControl)&&c(d.zoomsliderControl)&&d.zoomsliderControl===!1&&p.zoomsliderControl.removeFrom(p),!c(i.eventBroadcast))for(var v="broadcast",m=0;m<g.length;m++){var h=g[m];p.on(h,f(e,h,v),{eventName:h})}p.whenReady(function(){a.setMap(p,i.id)}),e.$on("$destroy",function(){a.getMap().then(function(e){e.remove()}),a.unresolveMap(i.id)}),e.$on("invalidateSize",function(){p.invalidateSize()})}}}]),angular.module("leaflet-directive").directive("center",["$log","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletEvents",function(e,a,r,t,n,o,l,i){var s,u=o.isDefined,c=o.isNumber,d=o.isSameCenterOnMap,f=o.safeApply,g=o.isValidCenter,p=l.isValidBounds,y=o.isUndefinedOrEmpty,v=function(e,a){return u(e)&&p(e)&&y(a)};return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){s=a.defer(),this.getCenter=function(){return s.promise}},link:function(a,o,p,y){var m=y.getLeafletScope(),L=m.center;y.getMap().then(function(o){var y=n.getDefaults(p.id);if(-1!==p.center.search("-"))return e.error('The "center" variable can\'t use a "-" on his key name: "'+p.center+'".'),void o.setView([y.center.lat,y.center.lng],y.center.zoom);if(v(m.bounds,L))o.fitBounds(l.createLeafletBounds(m.bounds)),L=o.getCenter(),f(m,function(e){e.center={lat:o.getCenter().lat,lng:o.getCenter().lng,zoom:o.getZoom(),autoDiscover:!1}}),f(m,function(e){var a=o.getBounds();e.bounds={northEast:{lat:a._northEast.lat,lng:a._northEast.lng},southWest:{lat:a._southWest.lat,lng:a._southWest.lng}}});else{if(!u(L))return e.error('The "center" property is not defined in the main scope'),void o.setView([y.center.lat,y.center.lng],y.center.zoom);u(L.lat)&&u(L.lng)||u(L.autoDiscover)||angular.copy(y.center,L)}var h,b;if("yes"===p.urlHashCenter){var k=function(){var e,a=r.search();if(u(a.c)){var t=a.c.split(":");3===t.length&&(e={lat:parseFloat(t[0]),lng:parseFloat(t[1]),zoom:parseInt(t[2],10)})}return e};h=k(),m.$on("$locationChangeSuccess",function(e){var a=e.currentScope,r=k();u(r)&&!d(r,o)&&(a.center={lat:r.lat,lng:r.lng,zoom:r.zoom})})}m.$watch("center",function(a){return u(h)&&(angular.copy(h,a),h=void 0),g(a)||a.autoDiscover===!0?a.autoDiscover===!0?(c(a.zoom)||o.setView([y.center.lat,y.center.lng],y.center.zoom),void o.locate(c(a.zoom)&&a.zoom>y.center.zoom?{setView:!0,maxZoom:a.zoom}:u(y.maxZoom)?{setView:!0,maxZoom:y.maxZoom}:{setView:!0})):void(b&&d(a,o)||(m.settingCenterFromScope=!0,o.setView([a.lat,a.lng],a.zoom),i.notifyCenterChangedToBounds(m,o),t(function(){m.settingCenterFromScope=!1}))):void e.warn("[AngularJS - Leaflet] invalid 'center'")},!0),o.whenReady(function(){b=!0}),o.on("moveend",function(){s.resolve(),i.notifyCenterUrlHashChanged(m,o,p,r.search()),d(L,o)||a.settingCenterFromScope||f(m,function(e){m.settingCenterFromScope||(e.center={lat:o.getCenter().lat,lng:o.getCenter().lng,zoom:o.getZoom(),autoDiscover:!1}),i.notifyCenterChangedToBounds(m,o)})}),L.autoDiscover===!0&&o.on("locationerror",function(){e.warn("[AngularJS - Leaflet] The Geolocation API is unauthorized on this page."),g(L)?(o.setView([L.lat,L.lng],L.zoom),i.notifyCenterChangedToBounds(m,o)):(o.setView([y.center.lat,y.center.lng],y.center.zoom),i.notifyCenterChangedToBounds(m,o))})})}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData","leafletMapDefaults","leafletHelpers",function(e,a,r,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(n,o,l,i){var s=t.isDefined,u=i.getLeafletScope(),c=u.tiles;return s(c)||s(c.url)?void i.getMap().then(function(e){var t,n=r.getDefaults(l.id);u.$watch("tiles",function(r){var o=n.tileLayerOptions,i=n.tileLayer;return!s(r.url)&&s(t)?void e.removeLayer(t):s(t)?s(r.url)&&s(r.options)&&!angular.equals(r.options,o)?(e.removeLayer(t),o=n.tileLayerOptions,angular.copy(r.options,o),i=r.url,t=L.tileLayer(i,o),t.addTo(e),void a.setTiles(t,l.id)):void(s(r.url)&&t.setUrl(r.url)):(s(r.options)&&angular.copy(r.options,o),s(r.url)&&(i=r.url),t=L.tileLayer(i,o),t.addTo(e),void a.setTiles(t,l.id))},!0)}):void e.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),angular.module("leaflet-directive").directive("legend",["$log","$http","leafletHelpers","leafletLegendHelpers",function(e,a,r,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(n,o,l,i){var s,u,c,d,f=r.isArray,g=r.isDefined,p=r.isFunction,y=i.getLeafletScope(),v=y.legend;y.$watch("legend",function(e){g(e)&&(s=e.legendClass?e.legendClass:"legend",u=e.position||"bottomright",d=e.type||"arcgis")},!0),i.getMap().then(function(r){y.$watch("legend",function(a){return g(a)?g(a.url)||"arcgis"!==d||f(a.colors)&&f(a.labels)&&a.colors.length===a.labels.length?g(a.url)?void e.info("[AngularJS - Leaflet] loading legend service."):(g(c)&&(c.removeFrom(r),c=null),c=L.control({position:u}),"arcgis"===d&&(c.onAdd=t.getOnAddArrayLegend(a,s)),void c.addTo(r)):void e.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set."):void(g(c)&&(c.removeFrom(r),c=null))}),y.$watch("legend.url",function(n){g(n)&&a.get(n).success(function(e){g(c)?t.updateLegend(c.getContainer(),e,d,n):(c=L.control({position:u}),c.onAdd=t.getOnAddLegend(e,s,d,n),c.addTo(r)),g(v.loadedData)&&p(v.loadedData)&&v.loadedData()}).error(function(){e.warn("[AngularJS - Leaflet] legend.url not loaded.")})})})}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope","leafletData","leafletHelpers",function(e,a,r,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,n,o,l){var i=t.safeApply,s=t.isDefined,u=l.getLeafletScope(),c={};l.getMap().then(function(e){u.$watchCollection("geojson",function(n){if(s(c)&&e.hasLayer(c)&&e.removeLayer(c),s(n)&&s(n.data)){var l,d=n.resetStyleOnMouseout;l=angular.isFunction(n.onEachFeature)?n.onEachFeature:function(e,r){t.LabelPlugin.isLoaded()&&s(n.label)&&r.bindLabel(e.properties.description),r.on({mouseover:function(r){i(u,function(){a.$broadcast("leafletDirectiveMap.geojsonMouseover",e,r)})},mouseout:function(e){d&&c.resetStyle(e.target),i(u,function(){a.$broadcast("leafletDirectiveMap.geojsonMouseout",e)})},click:function(r){i(u,function(){a.$broadcast("leafletDirectiveMap.geojsonClick",e,r)})}})},s(n.options)||(n.options={style:n.style,filter:n.filter,onEachFeature:l,pointToLayer:n.pointToLayer}),c=L.geoJson(n.data,n.options),r.setGeoJSON(c,o.id),c.addTo(e)}})})}}}]),angular.module("leaflet-directive").directive("layers",["$log","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,a,r,t,n,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=a.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,a,l,i){var s=t.isDefined,u={},c=i.getLeafletScope(),d=c.layers,f=n.createLayer,g=o.updateLayersControl,p=!1;i.getMap().then(function(a){e._leafletLayers.resolve(u),r.setLayers(u,l.id),u.baselayers={},u.overlays={};var t=l.id,n=!1;for(var o in d.baselayers){var i=f(d.baselayers[o]);s(i)?(u.baselayers[o]=i,d.baselayers[o].top===!0&&(a.addLayer(u.baselayers[o]),n=!0)):delete d.baselayers[o]}!n&&Object.keys(u.baselayers).length>0&&a.addLayer(u.baselayers[Object.keys(d.baselayers)[0]]);for(o in d.overlays){"cartodb"===d.overlays[o].type;var y=f(d.overlays[o]);s(y)?(u.overlays[o]=y,d.overlays[o].visible===!0&&a.addLayer(u.overlays[o])):delete d.overlays[o]}c.$watch("layers.baselayers",function(e){for(var r in u.baselayers)s(e[r])||(a.hasLayer(u.baselayers[r])&&a.removeLayer(u.baselayers[r]),delete u.baselayers[r]);for(var n in e)if(s(u.baselayers[n]))e[n].top!==!0||a.hasLayer(u.baselayers[n])?e[n].top===!1&&a.hasLayer(u.baselayers[n])&&a.removeLayer(u.baselayers[n]):a.addLayer(u.baselayers[n]);else{var o=f(e[n]);s(o)&&(u.baselayers[n]=o,e[n].top===!0&&a.addLayer(u.baselayers[n]))}var l=!1;for(var i in u.baselayers)if(a.hasLayer(u.baselayers[i])){l=!0;break}!l&&Object.keys(d.baselayers).length>0&&a.addLayer(u.baselayers[Object.keys(d.baselayers)[0]]),p=g(a,t,p,e,d.overlays,u)},!0),c.$watch("layers.overlays",function(e){for(var r in u.overlays)s(e[r])||(a.hasLayer(u.overlays[r])&&a.removeLayer(u.overlays[r]),delete u.overlays[r]);for(var n in e){if(!s(u.overlays[n])){var o=f(e[n]);s(o)&&(u.overlays[n]=o,e[n].visible===!0&&a.addLayer(u.overlays[n]))}e[n].visible&&!a.hasLayer(u.overlays[n])?a.addLayer(u.overlays[n]):e[n].visible===!1&&a.hasLayer(u.overlays[n])&&a.removeLayer(u.overlays[n]),e[n].visible&&a._loaded&&e[n].data&&"heatmap"===e[n].type&&(u.overlays[n].setData(e[n].data),u.overlays[n].update())}p=g(a,t,p,d.baselayers,e,u)},!0)})}}}]),angular.module("leaflet-directive").directive("bounds",["$log","$timeout","leafletHelpers","leafletBoundsHelpers",function(e,a,r,t){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","center"],link:function(n,o,l,i){var s=r.isDefined,u=t.createLeafletBounds,c=i[0].getLeafletScope(),d=i[0],f=function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng};d.getMap().then(function(r){c.$on("boundsChanged",function(e){var a=e.currentScope,t=r.getBounds();if(!f(t)&&!a.settingBoundsFromScope){var n={northEast:{lat:t._northEast.lat,lng:t._northEast.lng},southWest:{lat:t._southWest.lat,lng:t._southWest.lng}};angular.equals(a.bounds,n)||(a.bounds=n)}}),c.$watch("bounds",function(t){if(!s(t))return void e.error("[AngularJS - Leaflet] Invalid bounds");var o=u(t);o&&!r.getBounds().equals(o)&&(n.settingBoundsFromScope=!0,r.fitBounds(o),a(function(){n.settingBoundsFromScope=!1}))},!0)})}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletEvents",function(e,a,r,t,n,o,l,i){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(a,o,s,u){var c=u[0],d=n,f=n.isDefined,g=n.isString,p=c.getLeafletScope(),y=l.deleteMarker,v=l.addMarkerWatcher,m=l.listenMarkerEvents,h=l.addMarkerToGroup,b=i.bindMarkerEvents,k=l.createMarker;c.getMap().then(function(a){var n,o={};n=f(u[1])?u[1].getLayers:function(){var e=r.defer();return e.resolve(),e.promise},n().then(function(r){t.setMarkers(o,s.id),p.$watch("markers",function(t){for(var n in o)f(t)&&f(t[n])||(y(o[n],a,r),delete o[n]);var i=!f(s.watchMarkers)||"true"===s.watchMarkers;for(var u in t)if(-1===u.search("-")){if(!f(o[u])){var c=t[u],A=k(c);if(!f(A)){e.error("[AngularJS - Leaflet] Received invalid data on the marker "+u+".");continue}if(o[u]=A,f(c.message)&&A.bindPopup(c.message,c.popupOptions),f(c.group)){var w=f(c.groupOption)?c.groupOption:null;h(A,c.group,w,a)}if(d.LabelPlugin.isLoaded()&&f(c.label)&&f(c.label.message)&&A.bindLabel(c.label.message,c.label.options),f(c)&&f(c.layer)){if(!g(c.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(r)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(r.overlays)||!f(r.overlays[c.layer])){e.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"');continue}var C=r.overlays[c.layer];if(!(C instanceof L.LayerGroup||C instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"');continue}C.addLayer(A),!i&&a.hasLayer(A)&&c.focus===!0&&l.manageOpenPopup(A,c)}else f(c.group)||(a.addLayer(A),i||c.focus!==!0||l.manageOpenPopup(A,c));i&&v(A,u,p,r,a),m(A,c,p,i),b(A,u,c,p)}}else e.error('The marker can\'t use a "-" on his key name: "'+u+'".')},!0)})})}}}]),angular.module("leaflet-directive").directive("paths",["$log","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletEvents",function(e,a,r,t,n,o,l){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(i,s,u,c){var d=c[0],f=n.isDefined,g=n.isString,p=d.getLeafletScope(),y=p.paths,v=o.createPath,m=l.bindPathEvents,h=o.setPathOptions;d.getMap().then(function(o){var l,i=t.getDefaults(u.id);l=f(c[1])?c[1].getLayers:function(){var e=a.defer();return e.resolve(),e.promise},f(y)&&l().then(function(a){var t={};r.setPaths(t,u.id);var l=!f(u.watchPaths)||"true"===u.watchPaths,s=function(e,r){var t=p.$watch('paths["'+r+'"]',function(r,n){if(!f(r)){if(f(n.layer))for(var l in a.overlays){var i=a.overlays[l];i.removeLayer(e)}return o.removeLayer(e),void t()}h(e,r.type,r)},!0)};p.$watchCollection("paths",function(r){for(var u in t)f(r[u])||(o.removeLayer(t[u]),delete t[u]);for(var c in r)if(0!==c.search("\\$"))if(-1===c.search("-")){if(!f(t[c])){var d=r[c],y=v(c,r[c],i);if(f(y)&&f(d.message)&&y.bindPopup(d.message),n.LabelPlugin.isLoaded()&&f(d.label)&&f(d.label.message)&&y.bindLabel(d.label.message,d.label.options),f(d)&&f(d.layer)){if(!g(d.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(a)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(a.overlays)||!f(a.overlays[d.layer])){e.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"');continue}var b=a.overlays[d.layer];if(!(b instanceof L.LayerGroup||b instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"');continue}t[c]=y,b.addLayer(y),l?s(y,c):h(y,d.type,d)}else f(y)&&(t[c]=y,o.addLayer(y),l?s(y,c):h(y,d.type,d));m(y,c,d,p)}}else e.error('[AngularJS - Leaflet] The path name "'+c+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("leaflet-directive").directive("controls",["$log","leafletHelpers",function(e,a){return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(e,r,t,n){if(n){var o=a.isDefined,l=n.getLeafletScope(),i=l.controls;n.getMap().then(function(e){if(o(L.Control.Draw)&&o(i.draw)){o(i.edit)||(i.edit={featureGroup:new L.FeatureGroup},e.addLayer(i.edit.featureGroup));var a=new L.Control.Draw(i);e.addControl(a)}if(o(i.scale)){var r=new L.control.scale;e.addControl(r)}if(o(i.custom))for(var t in i.custom)e.addControl(i.custom[t])})}}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope","leafletHelpers","leafletEvents",function(e,a,r,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(a,n,o,l){var i=r.isObject,s=r.isDefined,u=l.getLeafletScope(),c=u.eventBroadcast,d=t.getAvailableMapEvents(),f=t.genDispatchMapEvent;l.getMap().then(function(a){var r,t,n=[],o="broadcast";if(s(c.map))if(i(c.map))if("emit"!==c.map.logic&&"broadcast"!==c.map.logic?e.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):o=c.map.logic,i(c.map.enable)&&c.map.enable.length>=0)for(r=0;r<c.map.enable.length;r++)t=c.map.enable[r],-1===n.indexOf(t)&&-1!==d.indexOf(t)&&n.push(t);else e.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.");else e.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model.");else n=d;for(r=0;r<n.length;r++)t=n[r],a.on(t,f(u,t,o),{eventName:t})})}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log","leafletMapDefaults","leafletBoundsHelpers",function(e,a,r){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,a,t,n){var o=n.getLeafletScope(),l=r.isValidBounds;n.getMap().then(function(e){o.$watch("maxbounds",function(a){if(!l(a))return void e.setMaxBounds();var r=[[a.southWest.lat,a.southWest.lng],[a.northEast.lat,a.northEast.lng]];e.setMaxBounds(r),t.center||e.fitBounds(r)})})}}}]),angular.module("leaflet-directive").directive("decorations",["$log","leafletHelpers",function(e,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,t,n,o){function l(a){return c(a)&&c(a.coordinates)&&(u.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(a.coordinates)}function i(e,a){return c(e)&&c(a)&&c(a.coordinates)&&c(a.patterns)?(e.setPaths(a.coordinates),e.setPatterns(a.patterns),e):void 0}var s=o.getLeafletScope(),u=a.PolylineDecoratorPlugin,c=a.isDefined,d={};o.getMap().then(function(e){s.$watch("decorations",function(a){for(var r in d)c(a)&&c(a[r])||(e.removeLayer(d[r]),delete d[r]);for(var t in a){var n=a[t],o=l(n);c(o)&&(d[t]=o,e.addLayer(o),i(o,n))}},!0)})}}}]),angular.module("leaflet-directive").directive("layercontrol",["$log","leafletData","leafletHelpers",function(e,a,r){return{restrict:"E",scope:{},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(t,n,o){e.debug("[Angular Directive - Layers] layers",t,n);var l=r.safeApply,i=r.isDefined;angular.extend(t,{baselayer:"",icons:{uncheck:"fa fa-check-square-o",check:"fa fa-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up"},changeBaseLayer:function(e,n){r.safeApply(t,function(r){r.baselayer=e,a.getMap().then(function(n){a.getLayers().then(function(a){if(!n.hasLayer(a.baselayers[e])){for(var o in r.layers.baselayers)r.layers.baselayers[o].icon=r.icons.unradio,n.hasLayer(a.baselayers[o])&&n.removeLayer(a.baselayers[o]);n.addLayer(a.baselayers[e]),r.layers.baselayers[e].icon=t.icons.radio}})})}),n.preventDefault()},moveLayer:function(e,a,r){var n=Object.keys(t.layers.baselayers).length;if(a>=1+n&&a<=t.overlaysArray.length+n){var o;for(var i in t.layers.overlays)if(t.layers.overlays[i].index===a){o=t.layers.overlays[i];break}o&&l(t,function(){o.index=e.index,e.index=a})}r.stopPropagation(),r.preventDefault()},initIndex:function(e,a){var r=Object.keys(t.layers.baselayers).length;e.index=i(e.index)?e.index:a+r+1},toggleOpacity:function(a,r){if(e.debug("Event",a),r.visible){var n=angular.element(a.currentTarget);n.toggleClass(t.icons.close+" "+t.icons.open),n=n.parents(".lf-row").find(".lf-opacity"),n.toggle("fast",function(){l(t,function(){r.opacityControl=!r.opacityControl})})}a.stopPropagation(),a.preventDefault()},unsafeHTML:function(e){return o.trustAsHtml(e)}});var s=n.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><div class="lf-baselayers"><div class="lf-row" ng-repeat="(key, layer) in layers.baselayers"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><div class="lf-container"><div class="lf-row" ng-repeat="layer in overlaysArray | orderBy:\'index\':order" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-open" ng-class="layer.opacityControl? icons.close:icons.open" ng-click="toggleOpacity($event, layer)"></i></div></label><div class="lf-legend" ng-if="layer.legend" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity" ng-show="layer.visible &amp;&amp; layer.opacityControl"><input type="text" class="lf-opacity-control" name="lf-opacity-control" data-key="{{layer.index}}" /></div></div></div></div></div>',link:function(t,n,o,l){var i=r.isDefined,s=l.getLeafletScope(),u=s.layers;o.order=!i(o.order)||"normal"!==o.order&&"reverse"!==o.order?"normal":o.order,t.order="normal"===o.order,t.orderNumber="normal"===o.order?-1:1,t.layers=u,l.getMap().then(function(r){s.$watch("layers.baselayers",function(e){a.getLayers().then(function(a){var n;for(n in e)e[n].icon=r.hasLayer(a.baselayers[n])?t.icons.radio:t.icons.unradio})}),s.$watch("layers.overlays",function(o){var l=[];a.getLayers().then(function(e){for(var a in o)o[a].icon=t.icons[o[a].visible?"uncheck":"check"],l.push(o[a]),i(o[a].index)&&e.overlays[a].setZIndex&&e.overlays[a].setZIndex(o[a].index)});var s=t.$watch(function(){return n.children().size()>1?(n.find(".lf-overlays").trigger("resize"),n.find(".lf-opacity").size()===Object.keys(u.overlays).length):void 0},function(o){o===!0&&(i(n.find(".lf-opacity-control").ionRangeSlider)?n.find(".lf-opacity-control").each(function(e,n){var o,l=Object.keys(u.baselayers).length;for(var s in t.overlaysArray)t.overlaysArray[s].index===e+l+1&&(o=t.overlaysArray[s]);var c=angular.element(n),d=i(o)&&i(o.layerOptions)?o.layerOptions.opacity:void 0;c.ionRangeSlider({min:0,from:i(d)?Math.ceil(100*d):100,step:1,max:100,prettify:!1,hasGrid:!1,hideMinMax:!0,onChange:function(e){a.getLayers().then(function(a){var t,n,o=e.input.data().key;for(var l in u.overlays)if(u.overlays[l].index===o){t=a.overlays[l],n=u.overlays[l];break}r.hasLayer(t)&&(n.layerOptions=i(n.layerOptions)?n.layerOptions:{},n.layerOptions.opacity=e.input.val()/100,t.setOpacity&&t.setOpacity(e.input.val()/100),t.getLayers&&t.eachLayer&&t.eachLayer(function(a){a.setOpacity&&a.setOpacity(e.input.val()/100)}))})}})}):e.warn("[AngularJS - Leaflet] Ion Slide Range Plugin is not loaded"),s())});t.overlaysArray=l},!0)})}}}]),angular.module("leaflet-directive").service("leafletData",["$log","$q","leafletHelpers",function(e,a,r){var t=r.getDefer,n=r.getUnresolvedDefer,o=r.setResolvedDefer,l={},i={},s={},u={},c={},d={},f={},g={};this.setMap=function(e,a){var r=n(l,a);r.resolve(e),o(l,a)},this.getMap=function(e){var a=t(l,e);return a.promise},this.unresolveMap=function(e){var a=r.obtainEffectiveMapId(l,e);l[a]=void 0,i[a]=void 0,s[a]=void 0,u[a]=void 0,c[a]=void 0,d[a]=void 0,f[a]=void 0,g[a]=void 0},this.getPaths=function(e){var a=t(u,e);return a.promise},this.setPaths=function(e,a){var r=n(u,a);r.resolve(e),o(u,a)},this.getMarkers=function(e){var a=t(c,e);return a.promise},this.setMarkers=function(e,a){var r=n(c,a);r.resolve(e),o(c,a)},this.getLayers=function(e){var a=t(s,e);return a.promise},this.setLayers=function(e,a){var r=n(s,a);r.resolve(e),o(s,a)},this.getUTFGrid=function(e){var a=t(f,e);return a.promise},this.setUTFGrid=function(e,a){var r=n(f,a);r.resolve(e),o(f,a)},this.setTiles=function(e,a){var r=n(i,a);r.resolve(e),o(i,a)},this.getTiles=function(e){var a=t(i,e);return a.promise},this.setGeoJSON=function(e,a){var r=n(d,a);r.resolve(e),o(d,a)},this.getGeoJSON=function(e){var a=t(d,e);return a.promise},this.setDecorations=function(e,a){var r=n(g,a);r.resolve(e),o(g,a)},this.getDecorations=function(e){var a=t(g,e);return a.promise}}]),angular.module("leaflet-directive").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,a){function r(){return{keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var t=a.isDefined,n=a.isObject,o=a.obtainEffectiveMapId,l={};return{getDefaults:function(e){var a=o(l,e);return l[a]},getMapCreationDefaults:function(e){var a=o(l,e),r=l[a],n={maxZoom:r.maxZoom,keyboard:r.keyboard,dragging:r.dragging,zoomControl:r.zoomControl,doubleClickZoom:r.doubleClickZoom,scrollWheelZoom:r.scrollWheelZoom,tap:r.tap,touchZoom:r.touchZoom,attributionControl:r.attributionControl,worldCopyJump:r.worldCopyJump,crs:r.crs};if(t(r.minZoom)&&(n.minZoom=r.minZoom),t(r.zoomAnimation)&&(n.zoomAnimation=r.zoomAnimation),t(r.fadeAnimation)&&(n.fadeAnimation=r.fadeAnimation),t(r.markerZoomAnimation)&&(n.markerZoomAnimation=r.markerZoomAnimation),r.map)for(var i in r.map)n[i]=r.map[i];return n},setDefaults:function(e,a){var i=r();t(e)&&(i.doubleClickZoom=t(e.doubleClickZoom)?e.doubleClickZoom:i.doubleClickZoom,i.scrollWheelZoom=t(e.scrollWheelZoom)?e.scrollWheelZoom:i.doubleClickZoom,i.tap=t(e.tap)?e.tap:i.tap,i.touchZoom=t(e.touchZoom)?e.touchZoom:i.doubleClickZoom,i.zoomControl=t(e.zoomControl)?e.zoomControl:i.zoomControl,i.zoomsliderControl=t(e.zoomsliderControl)?e.zoomsliderControl:i.zoomsliderControl,i.attributionControl=t(e.attributionControl)?e.attributionControl:i.attributionControl,i.tileLayer=t(e.tileLayer)?e.tileLayer:i.tileLayer,i.zoomControlPosition=t(e.zoomControlPosition)?e.zoomControlPosition:i.zoomControlPosition,i.keyboard=t(e.keyboard)?e.keyboard:i.keyboard,i.dragging=t(e.dragging)?e.dragging:i.dragging,t(e.controls)&&angular.extend(i.controls,e.controls),n(e.crs)?i.crs=e.crs:t(L.CRS[e.crs])&&(i.crs=L.CRS[e.crs]),t(e.center)&&angular.copy(e.center,i.center),t(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,i.tileLayerOptions),t(e.maxZoom)&&(i.maxZoom=e.maxZoom),t(e.minZoom)&&(i.minZoom=e.minZoom),t(e.zoomAnimation)&&(i.zoomAnimation=e.zoomAnimation),t(e.fadeAnimation)&&(i.fadeAnimation=e.fadeAnimation),t(e.markerZoomAnimation)&&(i.markerZoomAnimation=e.markerZoomAnimation),t(e.worldCopyJump)&&(i.worldCopyJump=e.worldCopyJump),t(e.map)&&(i.map=e.map));var s=o(l,a);return l[s]=i,i}}}]),angular.module("leaflet-directive").factory("leafletEvents",["$rootScope","$q","$log","leafletHelpers",function(e,a,r,t){var n=t.safeApply,o=t.isDefined,l=t.isObject,i=t,s=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},u=function(e,a,r,t){for(var n=s(),o="markers."+t,l=0;l<n.length;l++){var i=n[l];r.label.on(i,f(e,i,a,r.label,o))}},c=function(a,r,t,o,l,i){return function(s){var u="leafletDirectiveMarker."+a;"click"===a?n(t,function(){e.$broadcast("leafletDirectiveMarkersClick",l)}):"dragend"===a&&(n(t,function(){i.lat=o.getLatLng().lat,i.lng=o.getLatLng().lng}),i.message&&i.focus===!0&&o.openPopup()),n(t,function(a){"emit"===r?a.$emit(u,{markerName:l,leafletEvent:s}):e.$broadcast(u,{markerName:l,leafletEvent:s})})}},d=function(a,r,t,o,l){return function(o){var i="leafletDirectivePath."+a;n(t,function(a){"emit"===r?a.$emit(i,{pathName:l,leafletEvent:o}):e.$broadcast(i,{pathName:l,leafletEvent:o})})}},f=function(a,r,t,o,l){return function(i){var s="leafletDirectiveLabel."+r,u=l.replace("markers.","");n(a,function(a){"emit"===t?a.$emit(s,{leafletEvent:i,label:o,markerName:u}):"broadcast"===t&&e.$broadcast(s,{leafletEvent:i,label:o,markerName:u})})}},g=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose"]},p=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailableMapEvents:function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},genDispatchMapEvent:function(a,r,t){return function(o){var l="leafletDirectiveMap."+r;n(a,function(a){"emit"===t?a.$emit(l,{leafletEvent:o}):"broadcast"===t&&e.$broadcast(l,{leafletEvent:o})})}},getAvailableMarkerEvents:g,getAvailablePathEvents:p,notifyCenterChangedToBounds:function(e){e.$broadcast("boundsChanged")},notifyCenterUrlHashChanged:function(e,a,r,t){if(o(r.urlHashCenter)){var n=a.getCenter(),l=n.lat.toFixed(4)+":"+n.lng.toFixed(4)+":"+a.getZoom();o(t.c)&&t.c===l||e.$emit("centerUrlHash",l)}},bindMarkerEvents:function(e,a,t,n){var s,d,f=[],p="emit";if(o(n.eventBroadcast))if(l(n.eventBroadcast))if(o(n.eventBroadcast.marker))if(l(n.eventBroadcast.marker)){void 0!==n.eventBroadcast.marker.logic&&null!==n.eventBroadcast.marker.logic&&("emit"!==n.eventBroadcast.marker.logic&&"broadcast"!==n.eventBroadcast.marker.logic?r.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===n.eventBroadcast.marker.logic&&(p="emit"));var y=!1,v=!1;if(void 0!==n.eventBroadcast.marker.enable&&null!==n.eventBroadcast.marker.enable&&"object"==typeof n.eventBroadcast.marker.enable&&(y=!0),void 0!==n.eventBroadcast.marker.disable&&null!==n.eventBroadcast.marker.disable&&"object"==typeof n.eventBroadcast.marker.disable&&(v=!0),y&&v)r.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(y||v)if(y)for(s=0;s<n.eventBroadcast.marker.enable.length;s++)d=n.eventBroadcast.marker.enable[s],-1!==f.indexOf(d)?r.warn("[AngularJS - Leaflet] This event "+d+" is already enabled"):-1===g().indexOf(d)?r.warn("[AngularJS - Leaflet] This event "+d+" does not exist"):f.push(d);else for(f=g(),s=0;s<n.eventBroadcast.marker.disable.length;s++){d=n.eventBroadcast.marker.disable[s];var m=f.indexOf(d);-1===m?r.warn("[AngularJS - Leaflet] This event "+d+" does not exist or has been already disabled"):f.splice(m,1)}else r.warn("[AngularJS - Leaflet] must enable or disable events")}else r.warn("[AngularJS - Leaflet] event-broadcast.marker must be an object check your model.");else f=g();else r.error("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else f=g();for(s=0;s<f.length;s++)d=f[s],e.on(d,c(d,p,n,e,a,t));i.LabelPlugin.isLoaded()&&o(e.label)&&u(n,p,e,a)},bindPathEvents:function(e,a,t,n){var s,c,f=[],g="broadcast";if(o(n.eventBroadcast))if(l(n.eventBroadcast))if(o(n.eventBroadcast.path))if(l(n.eventBroadcast.paths))r.warn("[AngularJS - Leaflet] event-broadcast.path must be an object check your model.");else{void 0!==n.eventBroadcast.path.logic&&null!==n.eventBroadcast.path.logic&&("emit"!==n.eventBroadcast.path.logic&&"broadcast"!==n.eventBroadcast.path.logic?r.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===n.eventBroadcast.path.logic&&(g="emit"));
var y=!1,v=!1;if(void 0!==n.eventBroadcast.path.enable&&null!==n.eventBroadcast.path.enable&&"object"==typeof n.eventBroadcast.path.enable&&(y=!0),void 0!==n.eventBroadcast.path.disable&&null!==n.eventBroadcast.path.disable&&"object"==typeof n.eventBroadcast.path.disable&&(v=!0),y&&v)r.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(y||v)if(y)for(s=0;s<n.eventBroadcast.path.enable.length;s++)c=n.eventBroadcast.path.enable[s],-1!==f.indexOf(c)?r.warn("[AngularJS - Leaflet] This event "+c+" is already enabled"):-1===p().indexOf(c)?r.warn("[AngularJS - Leaflet] This event "+c+" does not exist"):f.push(c);else for(f=p(),s=0;s<n.eventBroadcast.path.disable.length;s++){c=n.eventBroadcast.path.disable[s];var m=f.indexOf(c);-1===m?r.warn("[AngularJS - Leaflet] This event "+c+" does not exist or has been already disabled"):f.splice(m,1)}else r.warn("[AngularJS - Leaflet] must enable or disable events")}else f=p();else r.error("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else f=p();for(s=0;s<f.length;s++)c=f[s],e.on(c,d(c,g,n,f,a));i.LabelPlugin.isLoaded()&&o(e.label)&&u(n,g,e,a)}}}]),angular.module("leaflet-directive").factory("leafletLayerHelpers",["$rootScope","$log","leafletHelpers",function($rootScope,$log,leafletHelpers){function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):layerTypes[e.type].mustHaveKey&&!isDefined(e.key)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):!0:($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(!isString(e.name))return void $log.error("[AngularJS - Leaflet] A base layer must have a name");isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={});for(var a in e.layerParams)e.layerOptions[a]=e.layerParams[a];var r={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,type:e.layerType,bounds:e.bounds,key:e.key,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(r)}}var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isDefined=leafletHelpers.isDefined,utfGridCreateLayer=function(e){if(!Helpers.UTFGridPlugin.isLoaded())return void $log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.");var a=new L.UtfGrid(e.url,e.pluginOptions);return a.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),a.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),a.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),a},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var a="//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(a,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){return Helpers.GeoJSONPlugin.isLoaded()?new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options):void 0}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var a="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(a,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var a="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",r=L.tileLayer(a,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var t=utfGridCreateLayer(e);return L.layerGroup([r,t])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var a=[];return angular.forEach(e.options.layers,function(e){a.push(createLayer(e))}),L.layerGroup(a)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var a=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(a,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var a=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(a,e.options)}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var a=angular.copy(e.options);angular.extend(a,{url:e.url});var r=new lvector.AGS(a);return r.onAdd=function(e){this.setMap(e)},r.onRemove=function(){this.setMap(null)},r}}},dynamic:{mustHaveUrl:!0,createLayer:function(e){return Helpers.DynamicMapLayerPlugin.isLoaded()?L.esri.dynamicMapLayer(e.url,e.options):void 0}},markercluster:{mustHaveUrl:!1,createLayer:function(e){return Helpers.MarkerClusterPlugin.isLoaded()?new L.MarkerClusterGroup(e.options):void $log.error("[AngularJS - Leaflet] The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){return Helpers.BingLayerPlugin.isLoaded()?new L.BingLayer(e.key,e.options):void 0}},heatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatMapLayerPlugin.isLoaded()){var a=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&a.setData(e.data),a}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var a=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(a,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},custom:{createLayer:function(e){return e.layer instanceof L.Class?angular.copy(e.layer):void $log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};return{createLayer:createLayer}}]),angular.module("leaflet-directive").factory("leafletControlHelpers",["$rootScope","$log","leafletHelpers","leafletMapDefaults",function(e,a,r,t){var n,o=r.isObject,l=r.isDefined,i=function(e,a,r){var n=t.getDefaults(r);if(!n.controls.layers.visible)return!1;var l=0;return o(e)&&(l+=Object.keys(e).length),o(a)&&(l+=Object.keys(a).length),l>1},s=function(e){var a=t.getDefaults(e),r={collapsed:a.controls.layers.collapsed,position:a.controls.layers.position};angular.extend(r,a.controls.layers.options);var n;return n=a.controls.layers&&l(a.controls.layers.control)?a.controls.layers.control.apply(this,[[],[],r]):new L.control.layers([],[],r)};return{layersControlMustBeVisible:i,updateLayersControl:function(e,a,r,t,o,u){var c,d=i(t,o,a);if(l(n)&&r){for(c in u.baselayers)n.removeLayer(u.baselayers[c]);for(c in u.overlays)n.removeLayer(u.overlays[c]);n.removeFrom(e)}if(d){n=s(a);for(c in t){var f=l(t[c].layerOptions)&&t[c].layerOptions.showOnSelector===!1;!f&&l(u.baselayers[c])&&n.addBaseLayer(u.baselayers[c],t[c].name)}for(c in o){var g=l(o[c].layerOptions)&&o[c].layerOptions.showOnSelector===!1;!g&&l(u.overlays[c])&&n.addOverlay(u.overlays[c],o[c].name)}n.addTo(e)}return d}}}]),angular.module("leaflet-directive").factory("leafletLegendHelpers",function(){var e=function(e,a,r,t){if(e.innerHTML="",a.error)e.innerHTML+='<div class="info-title alert alert-danger">'+a.error.message+"</div>";else if("arcgis"===r)for(var n=0;n<a.layers.length;n++){var o=a.layers[n];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var l=0;l<o.legend.length;l++){var i=o.legend[l];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+i.contentType+";base64,"+i.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+i.label+"</div>"}}else"image"===r&&(e.innerHTML='<img src="'+t+'"/>')},a=function(a,r,t,n){return function(){var o=L.DomUtil.create("div",r);return L.Browser.touch?L.DomEvent.on(o,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation)),e(o,a,t,n),o}},r=function(e,a){return function(){for(var r=L.DomUtil.create("div",a),t=0;t<e.colors.length;t++)r.innerHTML+='<div class="outline"><i style="background:'+e.colors[t]+'"></i></div><div class="info-label">'+e.labels[t]+"</div>";return L.Browser.touch?L.DomEvent.on(r,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(r),L.DomEvent.on(r,"mousewheel",L.DomEvent.stopPropagation)),r}};return{getOnAddLegend:a,getOnAddArrayLegend:r,updateLegend:e}}),angular.module("leaflet-directive").factory("leafletPathsHelpers",["$rootScope","$log","leafletHelpers",function(e,a,r){function t(e){return e.filter(function(e){return c(e)}).map(function(e){return n(e)})}function n(e){return s(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function o(e){return e.map(function(e){return t(e)})}function l(e,a){for(var r={},t=0;t<d.length;t++){var n=d[t];i(e[n])?r[n]=e[n]:i(a.path[n])&&(r[n]=a.path[n])}return r}var i=r.isDefined,s=r.isArray,u=r.isNumber,c=r.isValidPoint,d=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"],f=function(e,a){for(var r={},t=0;t<d.length;t++){var n=d[t];i(a[n])&&(r[n]=a[n])}e.setStyle(a)},g=function(e){if(!s(e))return!1;for(var a=0;a<e.length;a++){var r=e[a];if(!c(r))return!1}return!0},p={polyline:{isValid:function(e){var a=e.latlngs;return g(a)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,a){e.setLatLngs(t(a.latlngs)),f(e,a)}},multiPolyline:{isValid:function(e){var a=e.latlngs;if(!s(a))return!1;for(var r in a){var t=a[r];if(!g(t))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,a){e.setLatLngs(o(a.latlngs)),f(e,a)}},polygon:{isValid:function(e){var a=e.latlngs;return g(a)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,a){e.setLatLngs(t(a.latlngs)),f(e,a)}},multiPolygon:{isValid:function(e){var a=e.latlngs;if(!s(a))return!1;for(var r in a){var t=a[r];if(!g(t))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,a){e.setLatLngs(o(a.latlngs)),f(e,a)}},rectangle:{isValid:function(e){var a=e.latlngs;if(!s(a)||2!==a.length)return!1;for(var r in a){var t=a[r];if(!c(t))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,a){e.setBounds(new L.LatLngBounds(t(a.latlngs))),f(e,a)}},circle:{isValid:function(e){var a=e.latlngs;return c(a)&&u(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,a){e.setLatLng(n(a.latlngs)),i(a.radius)&&e.setRadius(a.radius),f(e,a)}},circleMarker:{isValid:function(e){var a=e.latlngs;return c(a)&&u(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,a){e.setLatLng(n(a.latlngs)),i(a.radius)&&e.setRadius(a.radius),f(e,a)}}},y=function(e){var a={};return e.latlngs&&(a.latlngs=e.latlngs),e.radius&&(a.radius=e.radius),a};return{setPathOptions:function(e,a,r){i(a)||(a="polyline"),p[a].setPath(e,r)},createPath:function(e,r,t){i(r.type)||(r.type="polyline");var n=l(r,t),o=y(r);return p[r.type].isValid(o)?p[r.type].createPath(n):void a.error("[AngularJS - Leaflet] Invalid data passed to the "+r.type+" path")}}}]),angular.module("leaflet-directive").factory("leafletBoundsHelpers",["$log","leafletHelpers",function(e,a){function r(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}var t=a.isArray,n=a.isNumber;return{createLeafletBounds:function(e){return r(e)?L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng]):void 0},isValidBounds:r,createBoundsFromArray:function(a){return t(a)&&2===a.length&&t(a[0])&&t(a[1])&&2===a[0].length&&2===a[1].length&&n(a[0][0])&&n(a[0][1])&&n(a[1][0])&&n(a[1][1])?{northEast:{lat:a[0][0],lng:a[0][1]},southWest:{lat:a[1][0],lng:a[1][1]}}:void e.error("[AngularJS - Leaflet] The bounds array is not valid.")}}}]),angular.module("leaflet-directive").factory("leafletMarkersHelpers",["$rootScope","leafletHelpers","$log","$compile",function(e,a,r,t){var n=a.isDefined,o=a.MarkerClusterPlugin,l=a.AwesomeMarkersPlugin,i=a.MakiMarkersPlugin,s=a.ExtraMarkersPlugin,u=a.safeApply,c=a,d=a.isString,f=a.isNumber,g=a.isObject,p={},y=function(e){if(n(e)&&n(e.type)&&"awesomeMarker"===e.type)return l.isLoaded()||r.error("[AngularJS - Leaflet] The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(e);if(n(e)&&n(e.type)&&"makiMarker"===e.type)return i.isLoaded()||r.error("[AngularJS - Leaflet] The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(e);if(n(e)&&n(e.type)&&"extraMarker"===e.type)return s.isLoaded()||r.error("[AngularJS - Leaflet] The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(e);if(n(e)&&n(e.type)&&"div"===e.type)return new L.divIcon(e);var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=";return n(e)&&n(e.iconUrl)?new L.Icon(e):new L.Icon.Default({iconUrl:a,shadowUrl:t,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},v=function(e){n(p[e])&&p.splice(e,1)},m=function(){p={}},h=function(e,a,r){if(e.closePopup(),n(r)&&n(r.overlays))for(var t in r.overlays)if((r.overlays[t]instanceof L.LayerGroup||r.overlays[t]instanceof L.FeatureGroup)&&r.overlays[t].hasLayer(e))return void r.overlays[t].removeLayer(e);if(n(p))for(var o in p)p[o].hasLayer(e)&&p[o].removeLayer(e);a.hasLayer(e)&&a.removeLayer(e)},b=function(a,r){a.openPopup();var o=a.getPopup(),l=angular.isFunction(r.getMessageScope)?r.getMessageScope():e,i=n(r.compileMessage)?r.compileMessage:!0;if(n(o)){var s=function(e){e._updateLayout(),e._updatePosition()};if(i)if(t(o._contentNode)(l),n(o._contentNode)&&o._contentNode.innerHTML.indexOf("ngInclude")>-1)var u=l.$on("$includeContentLoaded",function(){s(o),u()});else s(o)}c.LabelPlugin.isLoaded()&&n(r.label)&&n(r.label.options)&&r.label.options.noHide===!0&&(i&&t(a.label._container)(l),a.showLabel())};return{resetMarkerGroup:v,resetMarkerGroups:m,deleteMarker:h,manageOpenPopup:b,createMarker:function(e){if(!n(e))return void r.error("[AngularJS - Leaflet] The marker definition is not valid.");var a={icon:y(e.icon),title:n(e.title)?e.title:"",draggable:n(e.draggable)?e.draggable:!1,clickable:n(e.clickable)?e.clickable:!0,riseOnHover:n(e.riseOnHover)?e.riseOnHover:!1,zIndexOffset:n(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:n(e.iconAngle)?e.iconAngle:0};for(var t in e)e.hasOwnProperty(t)&&!a.hasOwnProperty(t)&&(a[t]=e[t]);var o=new L.marker(e,a);return d(e.message)||o.unbindPopup(),o},addMarkerToGroup:function(e,a,t,l){return d(a)?o.isLoaded()?(n(p[a])||(p[a]=new L.MarkerClusterGroup(t),l.addLayer(p[a])),void p[a].addLayer(e)):void r.error("[AngularJS - Leaflet] The MarkerCluster plugin is not loaded."):void r.error("[AngularJS - Leaflet] The marker group you have specified is invalid.")},listenMarkerEvents:function(e,a,r,t){e.on("popupopen",function(){t?u(r,function(){a.focus=!0}):b(e,a)}),e.on("popupclose",function(){t&&u(r,function(){a.focus=!1})})},addMarkerWatcher:function(e,a,t,o,l){var i=t.$watch('markers["'+a+'"]',function(a,t){if(!n(a))return h(e,l,o),void i();if(n(t)){if(!f(a.lat)||!f(a.lng))return r.warn("There are problems with lat-lng data, please verify your marker model"),void h(e,l,o);var s=a===t;if(n(a.iconAngle)&&t.iconAngle!==a.iconAngle&&e.setIconAngle(a.iconAngle),d(a.layer)||d(t.layer)&&(n(o.overlays[t.layer])&&o.overlays[t.layer].hasLayer(e)&&(o.overlays[t.layer].removeLayer(e),e.closePopup()),l.hasLayer(e)||l.addLayer(e)),(f(a.opacity)||f(parseFloat(a.opacity)))&&a.opacity!==t.opacity&&e.setOpacity(a.opacity),d(a.layer)&&t.layer!==a.layer){if(d(t.layer)&&n(o.overlays[t.layer])&&o.overlays[t.layer].hasLayer(e)&&o.overlays[t.layer].removeLayer(e),e.closePopup(),l.hasLayer(e)&&l.removeLayer(e),!n(o.overlays[a.layer]))return void r.error("[AngularJS - Leaflet] You must use a name of an existing layer");var u=o.overlays[a.layer];if(!(u instanceof L.LayerGroup||u instanceof L.FeatureGroup))return void r.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group" or "featureGroup"');u.addLayer(e),l.hasLayer(e)&&a.focus===!0&&b(e,a)}if(a.draggable!==!0&&t.draggable===!0&&n(e.dragging)&&e.dragging.disable(),a.draggable===!0&&t.draggable!==!0&&(e.dragging?e.dragging.enable():L.Handler.MarkerDrag&&(e.dragging=new L.Handler.MarkerDrag(e),e.options.draggable=!0,e.dragging.enable())),g(a.icon)||g(t.icon)&&(e.setIcon(y()),e.closePopup(),e.unbindPopup(),d(a.message)&&e.bindPopup(a.message,a.popupOptions)),g(a.icon)&&g(t.icon)&&!angular.equals(a.icon,t.icon)){var p=!1;e.dragging&&(p=e.dragging.enabled()),e.setIcon(y(a.icon)),p&&e.dragging.enable(),e.closePopup(),e.unbindPopup(),d(a.message)&&e.bindPopup(a.message,a.popupOptions)}!d(a.message)&&d(t.message)&&(e.closePopup(),e.unbindPopup()),c.LabelPlugin.isLoaded()&&n(a.label)&&n(a.label.message)&&!angular.equals(a.label.message,t.label.message)&&e.updateLabelContent(a.label.message),d(a.message)&&!d(t.message)&&e.bindPopup(a.message,a.popupOptions),d(a.message)&&d(t.message)&&a.message!==t.message&&e.setPopupContent(a.message);var v=!1;a.focus!==!0&&t.focus===!0&&(e.closePopup(),v=!0),(a.focus===!0&&(!n(t.focus)||t.focus===!1)||s&&a.focus===!0)&&(b(e,a),v=!0),t.zIndexOffset!==a.zIndexOffset&&e.setZIndexOffset(a.zIndexOffset);var m=e.getLatLng(),k=d(a.layer)&&c.MarkerClusterPlugin.is(o.overlays[a.layer]);k?v?(a.lat!==t.lat||a.lng!==t.lng)&&(o.overlays[a.layer].removeLayer(e),e.setLatLng([a.lat,a.lng]),o.overlays[a.layer].addLayer(e)):m.lat!==a.lat||m.lng!==a.lng?(o.overlays[a.layer].removeLayer(e),e.setLatLng([a.lat,a.lng]),o.overlays[a.layer].addLayer(e)):a.lat!==t.lat||a.lng!==t.lng?(o.overlays[a.layer].removeLayer(e),e.setLatLng([a.lat,a.lng]),o.overlays[a.layer].addLayer(e)):g(a.icon)&&g(t.icon)&&!angular.equals(a.icon,t.icon)&&(o.overlays[a.layer].removeLayer(e),o.overlays[a.layer].addLayer(e)):(m.lat!==a.lat||m.lng!==a.lng)&&e.setLatLng([a.lat,a.lng])}},!0)}}}]),angular.module("leaflet-directive").factory("leafletHelpers",["$q","$log",function(e,a){function r(e,r){var t,n;if(angular.isDefined(r))t=r;else if(0===Object.keys(e).length)t="main";else if(Object.keys(e).length>=1)for(n in e)e.hasOwnProperty(n)&&(t=n);else 0===Object.keys(e).length?t="main":a.error("[AngularJS - Leaflet] - You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call");return t}function t(a,t){var n,o=r(a,t);return angular.isDefined(a[o])&&a[o].resolvedDefer!==!0?n=a[o].defer:(n=e.defer(),a[o]={defer:n,resolvedDefer:!1}),n}return{isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:function(e){return angular.isDefined(e)&&null!==e},isNumber:function(e){return angular.isNumber(e)},isString:function(e){return angular.isString(e)},isArray:function(e){return angular.isArray(e)},isObject:function(e){return angular.isObject(e)},isFunction:function(e){return angular.isFunction(e)},equals:function(e,a){return angular.equals(e,a)},isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return angular.isDefined(e)?angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng):!1},isSameCenterOnMap:function(e,a){var r=a.getCenter(),t=a.getZoom();return e.lat&&e.lng&&r.lat.toFixed(4)===e.lat.toFixed(4)&&r.lng.toFixed(4)===e.lng.toFixed(4)&&t===e.zoom?!0:!1},safeApply:function(e,a){var r=e.$root.$$phase;"$apply"===r||"$digest"===r?e.$eval(a):e.$apply(a)},obtainEffectiveMapId:r,getDefer:function(e,a){var n,o=r(e,a);return n=angular.isDefined(e[o])&&e[o].resolvedDefer!==!1?e[o].defer:t(e,a)},getUnresolvedDefer:t,setResolvedDefer:function(e,a){var t=r(e,a);e[t].resolvedDefer=!0},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.AwesomeMarkers.Icon:!1},equal:function(e,a){return this.isLoaded()&&this.is(e)?angular.equals(e,a):!1}},PolylineDecoratorPlugin:{isLoaded:function(){return angular.isDefined(L.PolylineDecorator)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.PolylineDecorator:!1},equal:function(e,a){return this.isLoaded()&&this.is(e)?angular.equals(e,a):!1}},MakiMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.MakiMarkers)&&angular.isDefined(L.MakiMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.MakiMarkers.Icon:!1},equal:function(e,a){return this.isLoaded()&&this.is(e)?angular.equals(e,a):!1}},ExtraMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.ExtraMarkers)&&angular.isDefined(L.ExtraMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.ExtraMarkers.Icon:!1},equal:function(e,a){return this.isLoaded()&&this.is(e)?angular.equals(e,a):!1}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return this.isLoaded()?e instanceof L.Google:!1}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return this.isLoaded()?e instanceof L.BingLayer:!1}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return this.isLoaded()?e instanceof L.GeoJSON.WFS:!1}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return this.isLoaded()?e instanceof lvector.AGS:!1}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return this.isLoaded()?e instanceof L.Yandex:!1}},DynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.dynamicMapLayer:!1}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return this.isLoaded()?e instanceof L.TileLayer.GeoJSON:!1}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(a.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,a){return this.is(e)?angular.equals(e,a):!1}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,a){return this.is(e)?angular.equals(e,a):!1}}}}}])}();